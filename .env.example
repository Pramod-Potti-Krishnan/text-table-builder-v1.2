# =============================================================================
# Text & Table Builder v1.2 - Environment Configuration
# =============================================================================

# -----------------------------------------------------------------------------
# Google Cloud / Vertex AI Configuration
# -----------------------------------------------------------------------------

# REQUIRED: Google Cloud Project ID for Vertex AI
GCP_PROJECT_ID=your-project-id

# OPTIONAL: GCP Location (default: us-central1)
GCP_LOCATION=us-central1

# OPTIONAL: Service Account JSON (for Railway/Production)
# For local development, use Application Default Credentials (gcloud auth application-default login)
# For production, set this to the full JSON string of your service account key
GCP_SERVICE_ACCOUNT_JSON=

# -----------------------------------------------------------------------------
# LLM Configuration
# -----------------------------------------------------------------------------

# LLM Provider (gemini, openai, anthropic)
LLM_PROVIDER=gemini

# Gemini Model Names
GEMINI_FLASH_MODEL=gemini-2.5-flash
GEMINI_PRO_MODEL=gemini-2.5-pro

# Model Selection Strategy
# Enable automatic routing: Flash for simple elements, Pro for complex
ENABLE_MODEL_ROUTING=true

# Generation Parameters
LLM_TEMPERATURE=0.7
LLM_MAX_TOKENS=8192

# Vertex AI Rate Limiting & Retry Configuration
# Prevents 429 RESOURCE_EXHAUSTED errors from Vertex AI quota limits
MAX_VERTEX_RETRIES=5              # Maximum retry attempts for 429 errors
VERTEX_RETRY_BASE_DELAY=2         # Base delay in seconds for exponential backoff (2, 4, 8, 16, 32s)

# -----------------------------------------------------------------------------
# v1.2 Architecture Configuration
# -----------------------------------------------------------------------------

# Parallel Element Generation
ENABLE_PARALLEL_GENERATION=true
MAX_PARALLEL_WORKERS=5

# Character Count Validation
ENABLE_CHARACTER_VALIDATION=true

# Template Caching
ENABLE_TEMPLATE_CACHING=true

# -----------------------------------------------------------------------------
# Image Service Configuration (for Hero Slides with Background Images)
# -----------------------------------------------------------------------------

# Image Builder v2.0 API URL
IMAGE_SERVICE_URL=https://web-production-1b5df.up.railway.app

# OPTIONAL: API Key for Image Service (leave empty if not required)
IMAGE_SERVICE_API_KEY=

# Image generation timeout in seconds (recommended: 20)
IMAGE_SERVICE_TIMEOUT=20.0

# Enable/disable image-enhanced hero slides
IMAGE_SERVICE_ENABLED=true

# -----------------------------------------------------------------------------
# Theming System Configuration (Phase 1 - Feature Flags)
# -----------------------------------------------------------------------------

# Enable CSS variable-based theming for templates
# When false: Use hardcoded inline styles (current behavior)
# When true: Use CSS variable templates for variants in CSS_VARIABLE_TEMPLATES
USE_CSS_VARIABLES=false

# Comma-separated list of variant_ids that should use CSS variable templates
# Only applies when USE_CSS_VARIABLES=true
# Phase 1 pilot templates:
CSS_VARIABLE_TEMPLATES=metrics_3col_c1,grid_2x2_centered_c1,table_3col_c1,comparison_3col_c1,impact_quote_c1

# Theme system version for compatibility tracking
THEME_VERSION=1

# -----------------------------------------------------------------------------
# API Configuration
# -----------------------------------------------------------------------------

# FastAPI Settings
API_HOST=0.0.0.0
API_PORT=8100
API_RELOAD=true

# Logging
LOG_LEVEL=INFO

# -----------------------------------------------------------------------------
# Usage Notes
# -----------------------------------------------------------------------------

# Local Development Setup:
# 1. Install Google Cloud SDK: https://cloud.google.com/sdk/docs/install
# 2. Authenticate: gcloud auth application-default login
# 3. Set project: gcloud config set project YOUR_PROJECT_ID
# 4. Copy this file to .env and set GCP_PROJECT_ID
# 5. Run: uvicorn main:app --reload

# Production/Railway Setup:
# 1. Create a service account in Google Cloud Console
# 2. Grant "Vertex AI User" role to the service account
# 3. Download the service account JSON key
# 4. Set GCP_SERVICE_ACCOUNT_JSON environment variable to the JSON content
# 5. Set GCP_PROJECT_ID environment variable

# Model Routing Strategy:
# - SIMPLE elements (text_box, metric_card, quote): Use Flash (fast, cheap)
# - COMPLEX elements (table, comparison, multi-section): Use Pro (better quality)
# - Typical cost savings: 60-70% compared to using Pro for everything

# Parallel Generation Performance:
# - Sequential: ~4.2s for 4 elements
# - Parallel (5 workers): ~1.1s for 4 elements
# - 3.8x speedup with parallel processing

# Image-Enhanced Hero Slides:
# - New endpoints: /v1.2/hero/title-with-image, /v1.2/hero/section-with-image, /v1.2/hero/closing-with-image
# - Automatically generates contextual 16:9 background images
# - Graceful fallback to gradient backgrounds if image generation fails
# - Generation time: 10-15 seconds total (parallel image + content generation)
# - Requires httpx>=0.24.0 dependency
